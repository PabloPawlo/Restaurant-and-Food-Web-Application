<!DOCTYPE html>
<html>

<head>
   <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
   <link rel="icon" type="image/png" href="ico.png">
   <link rel="stylesheet" type="text/css" href="{{ url_for('static',filename='style.css') }}">
   <title>Client Page</title>
   <meta http-equiv="content-type" content="text/html; charset=utf-8">
   <meta name="author" content="Paweł Pawlica">
   <meta name="description" content="treść">
   <meta name="keywords" content="słowa kluczowe">
   <meta name="viewport" content="width=device-width, initial-scale=1.0" />

   <script src="https://unpkg.com/react@16/umd/react.development.js" crossorigin></script>
   <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js" crossorigin></script>
</head>

<body>


   <h3>Order your food - Flask SQLAlchemy</h3>
   <p><img src="http://anny.krakow.pl/wp-content/uploads/2015/05/czapa-kucharska.png" width="100" height="150"
         alt="Chef"></p>

   <div class="content">
      <ul>
         {% for food in foods %}
         <li class="foodz">
            <span>{{ food.name }}</span>

            <span>{{ food.time }}</span>

            <input type="hidden" value={{food.id}}>

            <input type="checkbox">
         </li>
         {%- endfor %}
      </ul>
      <span>
         <form method="post" id="post_order" class="hovers">
            <input type="text" name="uname" id="name" required/><br>
            <span><input type="submit" value="Submit" class="submitstyle" />
         </form>
      </span>




   </div>
   <footer class="footer">

      Paweł Pawlica<br>
      Politechnika Śląska<br>
      <i class="material-icons">cloud</i>
   </footer>




   <script>
      document.querySelector('form#post_order').onsubmit = function (e) {
         e.preventDefault();

         const listElements = document.querySelectorAll('li.foodz');
         const ids = [];
         for (const listElement of listElements) {
            if (listElement.querySelector('input[type=checkbox]').checked) {
               ids.push(listElement.querySelector('input[type=hidden]').value);
            }
         }
         console.log(ids);
         console.log(document.querySelector('#name'));
         const name = document.querySelector('#name').value;
         fetch('http://localhost:5000/post_order', {
            headers: {
               'Accept': 'application/json',
               'Content-Type': 'application/json'
            },
            method: 'POST',
            body: JSON.stringify({
               tab: ids,
               name: name
            })
         }).then(res => document.location = res.url).catch(err => console.warn(err));
      }








   </script>
</body>

</html>